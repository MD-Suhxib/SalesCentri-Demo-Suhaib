patch:
  summary: Update AI Call
  description: Update an existing AI call record by ID. All fields are optional. Email format is validated if provided and returns 422 if invalid.
  operationId: updateAiCall
  tags:
    - AI Call
  parameters:
    - name: id
      in: path
      required: true
      schema:
        type: integer
      description: AI call record ID
      example: 1
  requestBody:
    required: true
    content:
      application/json:
        schema:
          type: object
          properties:
            email:
              type: string
              format: email
              description: Email address (optional, validated for format if provided)
              example: "user@example.com"
            phone:
              type: string
              description: Phone number (optional, no validation)
              example: "+1234567890"
            subject:
              type: string
              nullable: true
              description: Call subject (optional)
              example: "Product Inquiry"
            transcript:
              type: string
              nullable: true
              description: Full call transcript (optional, can be very large)
              example: "Agent: Hello, how can I help you today? Customer: I'm interested in..."
            summary:
              type: string
              nullable: true
              description: Call summary (optional, can be very large)
              example: "Customer inquired about product features and pricing..."
            metadata:
              type: object
              nullable: true
              description: Additional metadata as JSON object (optional)
              additionalProperties: true
              example:
                duration: 300
                call_type: "inbound"
                agent_id: "agent_123"
  responses:
    "200":
      description: AI call updated successfully
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: true
                description: Indicates if the request was successful
              data:
                type: object
                properties:
                  call:
                    $ref: "#/components/schemas/AiCall"
                required:
                  - call
              error:
                type: object
                nullable: true
          example:
            success: true
            data:
              call:
                id: 1
                email: "user@example.com"
                phone: "+1234567890"
                subject: "Product Inquiry - Updated"
                transcript: "Agent: Hello, how can I help you today? Customer: I'm interested in..."
                summary: "Customer inquired about product features and pricing..."
                metadata:
                  duration: 300
                  call_type: "inbound"
                  agent_id: "agent_123"
                created_at: "2024-01-15T10:30:00"
                updated_at: "2024-01-15T10:35:00"
    "400":
      description: Validation error
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              data:
                type: object
                nullable: true
              error:
                type: object
                properties:
                  code:
                    type: integer
                    example: 400
                  message:
                    type: string
                    examples:
                      - "Invalid ID"
                      - "Invalid JSON body"
                      - "No valid fields to update"
                      - "Invalid metadata JSON format"
    "404":
      description: AI call not found
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              data:
                type: object
                nullable: true
              error:
                type: object
                properties:
                  code:
                    type: integer
                    example: 404
                  message:
                    type: string
                    example: "AI call not found"
    "422":
      description: Unprocessable Entity - Invalid email format
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              data:
                type: object
                nullable: true
              error:
                type: object
                properties:
                  code:
                    type: integer
                    example: 422
                  message:
                    type: string
                    example: "Invalid email format"
    "500":
      description: Internal server error
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              data:
                type: object
                nullable: true
              error:
                type: object
                properties:
                  code:
                    type: integer
                    example: 500
                  message:
                    type: string
                    example: "Failed to update AI call"
